{%- style -%}
  #shopify-section-{{ section.id }} {
    --slideshow-width: {{ section.settings.slideshow_width }}%;
    --gap: {{ section.settings.gap }}px;
    --border-radius: {{ section.settings.border_radius }}px;
    --desktop-height: {{ section.settings.desktop_height }}px;
  }

  .slideshow-split__container {
    display: flex;
    gap: var(--gap);
    align-items: stretch;
    width: 100%;
  }

  .slideshow-split__main {
    width: var(--slideshow-width);
    flex-shrink: 0;
    position: relative;
    border-radius: var(--border-radius);
    overflow: hidden;
    height: var(--desktop-height) !important;
  }

  .slideshow-split__static {
    width: calc(100% - var(--slideshow-width) - var(--gap));
    display: flex;
    flex-direction: column;
    gap: var(--gap);
    flex-grow: 1;
    height: var(--desktop-height) !important;
  }

  .slideshow-split__static-item {
    flex: 1;
    position: relative;
    border-radius: var(--border-radius);
    overflow: hidden;
    height: auto !important;
  }

  .slideshow-split__image-link {
    display: block;
    width: 100%;
    height: 100%;
  }

  .slideshow-split__image-link img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  /* Swiper Customization */
  .slideshow-split .swiper {
    width: 100% !important;
    height: 100% !important;
    position: relative;
  }

  .slideshow-split .swiper-wrapper {
    height: 100% !important;
  }

  .slideshow-split .swiper-slide {
    height: 100% !important;
  }

  .slideshow-split .swiper-pagination {
    bottom: 20px !important;
    left: 50% !important;
    transform: translateX(-50%);
    width: auto !important;
    z-index: 10;
    display: flex;
    gap: 8px;
  }

  .slideshow-split .swiper-pagination-bullet {
    background: #fff !important;
    opacity: 0.6 !important;
    width: 10px !important;
    height: 10px !important;
    margin: 0 !important;
    transition: all 0.3s ease;
    border-radius: 50%;
    cursor: pointer;
  }

  .slideshow-split .swiper-pagination-bullet-active {
    background: var(--primary, #21395d) !important;
    opacity: 1 !important;
    width: 25px !important;
    border-radius: 5px !important;
  }

  .slideshow-split .swiper-button-next,
  .slideshow-split .swiper-button-prev {
    color: #fff;
    background: rgba(0,0,0,0.2);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    transition: all 0.3s ease;
  }

  .slideshow-split .swiper-button-next:hover,
  .slideshow-split .swiper-button-prev:hover {
    background: rgba(0,0,0,0.5);
  }

  .slideshow-split .swiper-button-next:after,
  .slideshow-split .swiper-button-prev:after {
    font-size: 18px;
  }

  @media (max-width: 991px) {
    .slideshow-split__main,
    .slideshow-split__static {
      height: auto;
    }
    .slideshow-split__container {
      flex-direction: column;
    }
    .slideshow-split__main,
    .slideshow-split__static {
      width: 100%;
    }
    .slideshow-split__static {
      flex-direction: row;
    }
    .slideshow-split__main {
      aspect-ratio: 16 / 8;
    }
    .slideshow-split__static-item {
      aspect-ratio: 16 / 8;
      height: auto;
    }
    .slideshow-split .swiper-pagination {
      bottom: 10px !important;
    }
  }

  @media (max-width: 575px) {
    .slideshow-split__static {
      flex-direction: column;
    }
  }
{%- endstyle -%}

{% render 'section-style' %}

<section class="section section--flush slideshow-split {{ section.settings.class }}" data-section-id="{{ section.id }}">
  <div class="shopify-container">
    <div class="slideshow-split__container">
      
      {%- assign slide_blocks = section.blocks | where: 'type', 'slide' -%}
      {%- if slide_blocks.size > 0 -%}
        <div class="slideshow-split__main">
          <div id="swiper-{{ section.id }}" class="ap-swiper swiper ap-object-loaded" 
            data-desktop-item="1"
            data-laptop-item="1"
            data-tablet-item="1"
            data-mobile-item="1"
            data-loop="true"
            data-navigation="{{ section.settings.show_navigation }}"
            data-pagination="{{ section.settings.show_pagination }}"
            data-space="0"
            data-space-desktop="0"
            data-rows="1"
            data-time="{% if section.settings.autoplay %}{{ section.settings.autoplay_speed | times: 1000 }}{% else %}0{% endif %}">
            
            <div class="swiper-wrapper">
              {%- for block in slide_blocks -%}
                <div class="swiper-slide" {{ block.shopify_attributes }}>
                  {%- if block.settings.link != blank -%}
                    <a href="{{ block.settings.link }}" class="slideshow-split__image-link">
                  {%- else -%}
                    <div class="slideshow-split__image-link">
                  {%- endif -%}
                    
                    {%- if block.settings.image != blank -%}
                      {{ block.settings.image | image_url: width: 2000 | image_tag: loading: 'lazy', class: 'slideshow-split__image' }}
                    {%- else -%}
                      {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder-svg' }}
                    {%- endif -%}

                  {%- if block.settings.link != blank -%}
                    </a>
                  {%- else -%}
                    </div>
                  {%- endif -%}
                </div>
              {%- endfor -%}
            </div>

            {%- if section.settings.show_pagination -%}
              <div class="swiper-pagination swiper-pagination_{{ section.id }}"></div>
            {%- endif -%}

            {%- if section.settings.show_navigation -%}
              <div class="swiper-button-prev swiper-button-prev_{{ section.id }}"></div>
              <div class="swiper-button-next swiper-button-next_{{ section.id }}"></div>
            {%- endif -%}
          </div>
        </div>
      {%- endif -%}

      {%- assign static_blocks = section.blocks | where: 'type', 'static_banner' -%}
      {%- if static_blocks.size > 0 -%}
        <div class="slideshow-split__static">
          {%- for block in static_blocks limit: 2 -%}
            <div class="slideshow-split__static-item" {{ block.shopify_attributes }}>
              {%- if block.settings.link != blank -%}
                <a href="{{ block.settings.link }}" class="slideshow-split__image-link">
              {%- else -%}
                <div class="slideshow-split__image-link">
              {%- endif -%}

                {%- if block.settings.image != blank -%}
                  {{ block.settings.image | image_url: width: 1200 | image_tag: loading: 'lazy', class: 'slideshow-split__image' }}
                {%- else -%}
                  {{ 'lifestyle-2' | placeholder_svg_tag: 'placeholder-svg' }}
                {%- endif -%}

              {%- if block.settings.link != blank -%}
                </a>
              {%- else -%}
                </div>
              {%- endif -%}
            </div>
          {%- endfor -%}
        </div>
      {%- endif -%}

    </div>
  </div>
</section>

{% schema %}
{
  "name": "Slideshow Split",
  "tag": "section",
  "class": "shopify-section--slideshow-split",
  "settings": [
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full width",
      "default": true
    },
    {
      "type": "number",
      "id": "content_width",
      "label": "Content width",
      "default": 1800
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color"
    },
    {
      "type": "text",
      "id": "class",
      "label": "Custom Class"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "desktop_height",
      "min": 200,
      "max": 800,
      "step": 10,
      "unit": "px",
      "label": "Desktop Height",
      "default": 600
    },
    {
      "type": "range",
      "id": "slideshow_width",
      "min": 30,
      "max": 80,
      "step": 5,
      "unit": "%",
      "label": "Slideshow Width (Desktop)",
      "default": 65
    },
    {
      "type": "range",
      "id": "gap",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Gap between banners",
      "default": 16
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Border Radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Slideshow Settings"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Enable Autoplay",
      "default": true
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "min": 3,
      "max": 10,
      "step": 1,
      "unit": "s",
      "label": "Autoplay Speed",
      "default": 5
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show Navigation Arrows",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_pagination",
      "label": "Show Pagination Dots",
      "default": true
    },
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "text",
      "id": "margin_desktop",
      "label": "Margin Desktop",
      "default": "60px 0"
    },
    {
      "type": "text",
      "id": "margin_tablet",
      "label": "Margin Tablet",
      "default": "40px 0"
    },
    {
      "type": "text",
      "id": "margin_mobile",
      "label": "Margin Mobile",
      "default": "30px 0"
    },
    {
      "type": "text",
      "id": "padding_desktop",
      "label": "Padding Desktop"
    },
    {
      "type": "text",
      "id": "padding_tablet",
      "label": "Padding Tablet"
    },
    {
      "type": "text",
      "id": "padding_mobile",
      "label": "Padding Mobile"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    },
    {
      "type": "static_banner",
      "name": "Static Banner",
      "limit": 2,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Slideshow Split",
      "blocks": [
        { "type": "slide" },
        { "type": "slide" },
        { "type": "static_banner" },
        { "type": "static_banner" }
      ]
    }
  ]
}
{% endschema %}
