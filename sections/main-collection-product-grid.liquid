{% style %}
  #shopify-section-{{ section.id }} {
    --section-products-per-row: 1;

    {%- if section.settings.margin_desktop != blank -%}
      margin: {{ section.settings.margin_desktop }};
    {%- endif -%}

    {%- if section.settings.padding_desktop != blank -%}
      padding: {{ section.settings.padding_desktop }};
    {%- endif -%}
  }


  #shopify-section-{{ section.id }} .ap-productlist__inner {
    gap: {{ section.settings.product_space |  append: 'px' }}
  }

  .load-more-spinner {
    display: none;
  }

  .show-more-product {
    width: fit-content;
    margin: 0 auto;
    position: relative;
    margin-top: 50px;
    color: #ffffff;
    background-color: #2ea5b6;
    border-radius: 100px;
    height: 48px;
    min-width: 100px;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .load-more-btn {
    padding: 14px 30px;
    font-size: 12px;
    line-height: 167%;  
    letter-spacing: 1px;
    font-family: var(--hd-font-family);
    
    text-transform: uppercase;
    transition: 0.3s all ease;
  }

    
 
    #shopify-section-{{ section.id }} .ap-productlist__inner {
      margin-left: 0;
      margin-right: 0;
      grid-template-columns: repeat({{ section.settings.columns_desktop }}, 1fr)
    }
  

    @media (max-width: 1199px) and (min-width: 768px) {
      #shopify-section-{{ section.id }} .ap-productlist__inner {
      grid-template-columns: repeat({{ section.settings.columns_tablet }}, 1fr)

      }
    }

    @media (max-width: 767px) and (min-width: 480px) {
      #shopify-section-{{ section.id }} .ap-productlist__inner {
      grid-template-columns: repeat({{ section.settings.columns_mobile }}, 1fr)

      }
    }

    @media (max-width: 479px) {
      #shopify-section-{{ section.id }} .ap-productlist__inner {
      grid-template-columns: 1fr;
    }
    }


  #block-template--14993172660432__main-e231065e-5bdb-4483-91fc-79c63ebbcffc {
    --heading-color: 255, 255, 255;
    --color-body: 255, 255, 255;
    --section-block-background: 247, 248, 253;
    --primary-button-background: 255, 255, 255;
    --primary-button-text-color: 30, 49, 106;--section-blocks-alignment: center;
  }
  #block-template--14993172660432__main-cb5ead93-c537-42ed-9e12-32caae9a0fff {
    --heading-color: 255, 255, 255;
    --color-body: 255, 255, 255;
    --section-block-background: 247, 248, 253;
    --primary-button-background: 255, 255, 255;
    --primary-button-text-color: 30, 49, 106;--section-blocks-alignment: center;
  }

  
  @media (max-width: 479px) {
    #shopify-section-{{ section.id }} {
      --section-products-per-row: 1;
    }
  }

  /*
  IMPLEMENTATION NOTE: due to design requirements, the mobile toolbar (with filters and sort by) had to be moved to the
  layout file. However as section settings cannot be accessed outside the section itself, we simply hide them in CSS.
  */

  @media screen and (max-width: 999px) {
    :root {
      --anchor-offset: 60px;
    }
  }
  @media screen and (max-width: 740px) {
    .ap-productlist {
      --ap-productlist-column-gap: 0px;
    }
  }

  {%- if template contains 'collection' -%}
  .ap-productfacet_aside__categories-title {
    padding-top: 0;
  }
  .ap-productfacet_aside__categories-list {
    display: flex;
    flex-direction: column;
    padding: 0;
    margin-bottom: 50px;
  }
  .ap-productfacet_aside__categories-list a {
    font-size: 16px;
    line-height: 26px;
    font-weight: 500;
    color: #555;
    display: inline-flex;
    align-items: center;
  }
  .ap-productfacet_aside__categories-list a:not(:last-child) {
    margin-bottom: 10px;
  }
  .ap-productfacet_aside__categories-list a:before {
    content: '';
    width: 6px;
    height: 6px;
    background: var(--primary-2);
    border-radius: 50%;
    margin-right: 10px;
  }
  
  .ap-productfacet_aside__categories-list a .count {
    flex: 1;
    text-align: right;
    color: #999;
  }
  .ap-productfacet_aside__categories-list a:hover {
    color: var(--primary_hover);
  }
  .ap-productfacet_aside__categories-list a:hover .count {
    color: var(--primary_hover);
  }
  .ap-productfacet_aside__categories-list a:hover:before {
    background: var(--primary_hover);
  }

  #shopify-section-{{ section.id }} #ap-sortbypopover .popover__choice-list {
    white-space: normal;
    display: grid;
    gap: 6px;
    padding: 4px 0;
  }

  #shopify-section-{{ section.id }} #ap-sortbypopover .popover__choice-item {
    text-align: left;
    margin-top: 0;
  }

  #shopify-section-{{ section.id }} #ap-sortbypopover .popover__choice-label {
    position: relative;
    display: block;
    width: 100%;
    padding: 8px 34px 8px 12px;
    border-radius: 10px;
    color: rgba(var(--color-body), 0.85);
    font-size: 14px;
    line-height: 20px;
    border: 1px solid transparent;
    margin: 0;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
  }

  #shopify-section-{{ section.id }} #ap-sortbypopover .popover__choice-label:hover {
    background: rgba(var(--root-primary-button-background), 0.06);
    color: rgb(var(--heading-color));
  }

  #shopify-section-{{ section.id }} #ap-sortbypopover input:checked + .popover__choice-label {
    background: rgba(var(--root-primary-button-background), 0.12);
    color: rgb(var(--heading-color));
    font-weight: 600;
    border-color: rgba(var(--root-primary-button-background), 0.2);
  }

  #shopify-section-{{ section.id }} #ap-sortbypopover {
    min-width: 260px;
    max-width: 320px;
  }
  #shopify-section-{{ section.id }} #ap-sortbypopover .popover__choice-label::after {
    content: none;
  }
  .banner {
    flex-direction: column;
    padding: 0;
    margin-bottom: 30px;
  }
  .c-banner-text-title-top {
    font-size: 18px;
    line-height: 30px;
    margin-bottom: 27px;
  }
  .c-banner-img-text {
    position: relative;
    width: 100%;
  }
  .c-list-image {
    width: 100%;
    object-fit: cover;
  }
  .c-banner-text {
    position: absolute;
    top: 50%;
    left: 105px;
    transform: translateY(-50%);
  }
  .c-banner-text-title {
    font-size: 40px;
    line-height: 38px;
    letter-spacing: 0;
    text-transform: uppercase;
    font-family: var(--hd-font-family);
    margin: 0 0 17px;
  }
  .c-banner-text-title span {
    color: var(--primary)
  }
  .c-banner-text-subtitle span {
    font-size: 20px;
    text-decoration: underline;
    text-transform: uppercase;
    font-weight: 500;
    line-height: 22px;
  }
  .c-banner-text-description {
    font-size: 18px;
    line-height: 1;
    text-decoration: line-through;
  }
  .c-banner-text-description span {
    font-size: 28px;
    line-height: 1;
    color: #ffde00;
    text-decoration: none;
    margin-left: 5px;
    display: inline-block;
  }
  body.collection .breadcrumb__list {
    padding: 0;
    margin: 0;
  }
  .c-banner-text-subtitle {
    font-size: 14px;
    font-weight: 500;
    margin: 0 0 11px;
  }
  @media (max-width: 1299px) {
    .c-list-image {
      min-height: 300px;
      object-fit: cover;
    }
    .c-banner-text {
      left: 15px;
    }
  }
  @media (max-width: 767px) {
    .c-banner-text {
      left: 50%;
      text-align: center;
      transform: translate(-50%,-50%);
      background-color: #000;
      padding: 15px
    }
    .c-banner-text-title {
      font-size: 28px;
      line-height: 1;
    }
  }
  @media (max-width: 740px) {
    .image-overlay {
      --image-height: 100%;
    }
  }
  @media (max-width: 480px) {
    .c-banner-text {
      width: 100%;
    }
  }

    {%- if section.settings.type_collection == 'collection-top' -%}
      .collection-top .c-banner-text-title-top {
        margin-top: 40px;
      }
      .collection-top .ap-productfacet {
        flex-direction: column;
      }
      .collection-top .filter-toggle {
        display: none;
      }
      .collection-top .collection-carousel-item-info {
        margin-top: 20px;
      }
      .collection-top .collection-carousel-title {
        font-size: 16px;
        line-height: 20px;
        text-align: center;
      }
      .collection-top .collection-carousel-item-image {
        width: 100%;
        object-fit: cover;
      }
      .collection-top .ap-productfacet__active-list {
        margin-top: 18px;
        margin-bottom: 18px;
      }
      .collection-top .ap-productfacet_aside__categories-list {
        padding:  0 0;
        margin-bottom: 0;

      }
      .collection-top  .ap-productfacet {
        margin-top: 0;
      }
      @media (min-width: 1000px) {
        .collection-top .drawer__header-action {
          display: none;
        }
        .collection-top .filter-toggle {
          display: flex;
          align-items: center;
          gap: 9px;
          cursor: pointer;
        }
        .collection-top .wp-productfacet__meta {
          display: flex;
          align-items: center;
          gap: 16px;
        }
        .collection-top  .ap-productfacet__aside {
          position: fixed;
          display: flex;
          flex-direction: column;
          top: 0;
          left: 0;
          right: auto;
          width: 89vw;
          max-width: 410px;
          height: 100%;
          max-height: 100vh;
          background: #fff;
          color: rgb(var(--color-body));
          z-index: 9999999;
          transform: translateX(-410px);
          visibility: hidden;
          font-size: 1rem;
          padding: 0 20px;
          transition: transform .6s cubic-bezier(.75,0,.175,1),visibility .6s cubic-bezier(.75,0,.175,1);
          overflow-y: auto;
          overflow-x: hidden;
        }
        .collection-top  .ap-productfacet__aside.open {
          visibility: visible;
          transform: translateX(0);
        }
        .collection-top  .drawer__overlay-filter.open {
          right: auto;
          left: 0;
          visibility: visible;
          opacity: .3;
        }
        .collection-top  .drawer__overlay-filter.open {
          z-index: 9999999;
        }
      }
    {%- endif -%}

  {%- endif -%}
{% endstyle %}

{%- assign sort_by = collection.sort_by | default: collection.default_sort_by -%}

{%- if template contains 'collection' or template contains 'search' -%}

        {%- if collection.template_suffix != 'services' -%}
          
        

        <div id="mobile-facet-toolbar" class="mobile-toolbar  hd-lap-and-up">
          <button is="toggle-button" class="mobile-toolbar__item mobile-toolbar__item--filters " ap-expanded-aria="false" ap-controlsaria="ap-facetfilters"><svg focusable="false" width="16" height="16" class="icon icon--filters   " viewBox="0 0 16 16">
        <path d="M0 4h16M0 12h16" fill="none" stroke="currentColor" stroke-width="2"></path>
        <circle cx="5" cy="4" r="2" fill="rgb(var(--background))" stroke="currentColor" stroke-width="2"></circle>
        <circle cx="11" cy="12" r="2" fill="rgb(var(--background))" stroke="currentColor" stroke-width="2"></circle>
      </svg><span class="mobile-toolbar__item-label">{{ 'products.facets.filter_button' | t }}</span>
          </button>

          <button is="toggle-button" class="mobile-toolbar__item mobile-toolbar__item--sort" ap-expanded-aria="false" ap-controlsaria="ap-sortbypopover">
            <span class="mobile-toolbar__item-label">{{ 'products.facets.sort_button' | t }}</span><svg focusable="false" width="12" height="8" class="icon icon--chevron   " viewBox="0 0 12 8">
        <path fill="none" d="M1 1l5 5 5-5" stroke="currentColor" stroke-width="2"></path>
      </svg></button>
        </div>
      {%- endif -%}
      {%- endif -%}

<section class="{%- if section.settings.type_collection == 'collection-top' -%}collection-top{% endif %}">
  <div class="{{ section.settings.setwidthout }}">
    <ap-productfacet class="ap-productfacet" section-id="{{ section.id }}">

      {%- if section.settings.type_collection == 'collection-top' -%}
        {% render 'product-filter-collection-top', sort_by: sort_by %}
      {%- else -%}
        {% render 'product-filter', sort_by: sort_by %}
      {%- endif -%}
      
      <div id="facet-main" class="ap-productfacet__main anchor" role="region" aria-live="polite">
        
        {% for block in section.blocks %}
          {% case block.type %}
            {%- when 'banner' -%}
              <div class="banner">
                <div style="color: {{ block.settings.color_title_top }}" class="c-banner-text-title-top">{{ block.settings.title_description }}</div>
                <div class="c-banner-img-text">
                  <div class="c-banner-image">
                    {% if block.settings.featured_image != blank %}
                      <img class="c-list-image" loading="lazy" 
                        sizes="(max-width: 740px) 80vw, (max-width: 999px) 60vw, 425px"
                        alt="" 
                        src="{{ block.settings.featured_image | image_url: width: block.settings.featured_image.width }}" 
                        data-srcset="{%- if block.settings.featured_image.width >= 3000 -%}{{ block.settings.featured_image | image_url: width: 3000, crop: 'center' }} 3000w,{%- endif -%}
                          {{ block.settings.featured_image | image_url }} {{ block.settings.featured_image.width }}w"
                        src="{{ block.settings.featured_image | image_url: width: 1500 }}"
                        height="{{ block.settings.featured_image.height }}"
                        width="{{ block.settings.featured_image.width }}">
                    {% else %}
                      {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                    {% endif %}
                  </div>
                  <div class="c-banner-text">
                    <h4 style="color: {{ block.settings.color_subtitle }}" class="c-banner-text-subtitle">{{ block.settings.sub_title }}</h4>
                    <h3 style="color: {{ block.settings.color_title }}" class="c-banner-text-title">{{ block.settings.title }}</h3>
                    {% if block.settings.description != blank %}
                    <p style="color: {{ block.settings.color_description }}" class="c-banner-text-description">{{ block.settings.description }}</p>
                    {% endif %}
                    {% if block.settings.button1_label != blank %}
                      <style>
                        #btn-{{ block.id }}.btn-base {
                          color: {{ block.settings.color_btn }};
                          background-color: {{ block.settings.bg_btn }};
                        }
                        #btn-{{ block.id }}.btn-base:hover {
                          color: {{ block.settings.color_btn_hover }};
                          background-color: {{ block.settings.bg_btn_hover }};
                        }
                      </style>
                    <a id="btn-{{ block.id }}" href="{{ block.settings.link1 }}" class="button btn-base btn-sm">
                      {{ block.settings.button1_label }}
                      {% render 'icon-arrow-2' %}
                    </a>
                    {% endif %}
                  </div>
                </div>
              </div>
          {% endcase %}
        {% endfor %}

        <div class="ap-productfacet__meta-bar anchor">
          {%- if section.settings.type_collection == 'collection-top' -%}
          <div class="wp-productfacet__meta">
            <div class="filter-toggle">
              {% render 'icon-filter-2' %}
              <span>{{ 'products.facets.filter_button' | t }}</span>
            </div>
            <span class="ap-productfacet__meta-bar-item ap-productfacet__meta-bar-item--count" role="status">
              {%- liquid
                assign products_count = collection.products_count
                for product in collection.products
                  if product.type == 'service'
                    assign products_count = products_count | minus: 1
                  endif
                endfor
                if products_count < 0
                  assign products_count = 0
                endif
              -%}
              {{ 'products.facets.product_count_simple' | t: count: products_count }}
            </span>
          </div>
          {%- else -%}
          <span class="ap-productfacet__meta-bar-item ap-productfacet__meta-bar-item--count" role="status">

              {%- liquid
                assign products_count = collection.products_count
              -%}

            
              {{ 'products.facets.product_count_simple' | t: count: products_count }}
          </span>
          {%- endif -%}
          <div class="ap-productfacet__meta-bar-item ap-productfacet__meta-bar-item--sort">
            <span class="ap-productfacet__sort-by-title text--subdued hd-pocket">{{ 'products.facets.sort_by_label' | t }}</span>
            <div class="popover-container">
              <button type="button" is="toggle-button" class="popover-button hd-pocket" ap-expanded-aria="false" ap-controlsaria="ap-sortbypopover">
                <span id="sort-by-selected-value" style="pointer-events: none">
                  {%- for option in collection.sort_options -%}
                    {% if option.value == sort_by %}
                      {{ option.name | escape }}
                    {% endif %}
                  {%- endfor -%}
                </span>
                <svg focusable="false" width="12" height="8" class="icon icon--chevron icon--inline  " viewBox="0 0 12 8">
                  <path fill="none" d="M1 1l5 5 5-5" stroke="currentColor" stroke-width="2"></path>
                </svg>
              </button>

              <ap-sortbypopover id="ap-sortbypopover" class="popover">
                <span class="popover__overlay"></span>
                <header class="popover__header">
                  <span class="popover__title heading h6">{{ 'products.facets.sort_by_label' | t }}</span>
                  <button type="button" class="popover__close-button tap-area tap-area--large" data-action="close" title="{{ 'accessibility.close' | t }}">
                    <svg focusable="false" width="14" height="14" class="icon icon--close   " viewBox="0 0 14 14">
                      <path d="M13 13L1 1M13 1L1 13" stroke="currentColor" stroke-width="2" fill="none"></path>
                    </svg>
                  </button>
                </header>

                <div class="popover__content">
                  <div class="popover__choice-list">
                    {%- for option in collection.sort_options -%}
                      <label class="popover__choice-item">
                        <input type="radio" data-bind-value="sort-by-selected-value" class="visually-hidden" {% if option.value == sort_by %}checked="checked"{% endif %} name="sort_by" value="{{ option.value | escape }}" title="{{ option.name | escape }}">
                        <span class="popover__choice-label">{{ option.name | escape }}</span>
                      </label>
                    {%- endfor -%}
                  </div>
                </div>
              </ap-sortbypopover>
            </div>
          </div>
        </div>

        {% liquid
          assign products_per_page = 12
          if section.settings.products_per_page
            assign products_per_page = section.settings.products_per_page
          endif
        %}

        {%- paginate collection.products by products_per_page -%}
          
          <ap-productlist class="ap-productfacet__ap-productlist ap-productlist anchor ap-object-loaded" stagger-apparition="">
            <div id="ap_productlist" class="ap-productlist__inner" data-next-url="{{ paginate.next.url }}">
              {%- for product in collection.products -%}
                
                  {% render 'product-grid', product: product, product_type: settings.product_type %}
                
              {%- endfor -%}
            </div>
            
            {% if section.settings.show_load_product %}
            {% comment %} <div id="ap_loadmoreproduct">
              <div id="loading-more-product-icon" style="display:none">
                {% render 'icon-loading' %}
              </div>
              <input type="hidden" id="ap_page_load" value="1">
              <input type="hidden" id="ap_max_page" value="{{ paginate.pages }}">
              <input type="hidden" id="ap_page_link" value="{{ collection.url }}">
            </div> {% endcomment %}

            {% endif %}

          
            

          </ap-productlist>

          
            {%- if paginate.pages > 1 -%}
              {% render 'pagination', paginate: paginate, anchor: '' %}
            {%- endif -%}

        {%- endpaginate -%}

        

      </div>

    </ap-productfacet>
  </div>
</section>


{% schema %}
{
  "name": "t:sections.main-collection-product-grid.name",
  "class": "shopify-section--main-collection",
  "settings": [
    {
      "type": "select",
      "id": "type_collection",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "collection-top",
          "label": "Collection Top"
        }
      ],
      "default": "default",
      "label": "Type Collection"
    },
    {
      "type": "select",
      "id": "setwidthout",
      "label": "Set Width",
      "default": "full",
      "options": [
        {
          "value": "container",
          "label": "Box"
        },
        {
          "value": "container-fluid",
          "label": "Container Fluid"
        },
        {
          "value": "full",
          "label": "Full"
        }
      ]
    },
    {
      "type": "text",
      "id": "margin_desktop",
      "label": "t:sections.all.margin_desktop.label",
      "info": "t:sections.all.margin_desktop.info"
    },
    {
      "type": "text",
      "id": "margin_tablet",
      "label": "t:sections.all.margin_tablet.label",
      "info": "t:sections.all.margin_tablet.info"
    },
    {
      "type": "text",
      "id": "margin_mobile",
      "label": "t:sections.all.margin_mobile.label",
      "info": "t:sections.all.margin_mobile.info"
    },
    {
      "type": "text",
      "id": "padding_desktop",
      "label": "t:sections.all.padding_desktop.label",
      "info": "t:sections.all.padding_desktop.info"
    },
    {
      "type": "text",
      "id": "padding_tablet",
      "label": "t:sections.all.padding_tablet.label",
      "info": "t:sections.all.padding_tablet.info"
    },
    {
      "type": "text",
      "id": "padding_mobile",
      "label": "t:sections.all.padding_mobile.label",
      "info": "t:sections.all.padding_mobile.info"
    },
    {
      "type": "header",
      "content": "Settings Filter"
    },
    {
      "type": "text",
      "id": "title_categories",
      "label": "Title Categories collection"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "collection",
      "id": "collection2",
      "label": "Collection 2"
    },
    {
      "type": "collection",
      "id": "collection3",
      "label": "Collection 3"
    },
    {
      "type": "collection",
      "id": "collection4",
      "label": "Collection 4"
    },
    {
      "type": "collection",
      "id": "collection5",
      "label": "Collection 5"
    },
    {
      "type": "collection",
      "id": "collection6",
      "label": "Collection 6"
    },
    {
      "type": "header",
      "content": "Settings Product"
    },
    {
      "type": "range",
      "id": "products_per_page",
      "min": 1,
      "max": 100,
      "step": 1,
      "default": 16,
      "label": "t:sections.main-collection-product-grid.settings.products_per_page.label"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 3,
      "label": "t:sections.main-collection-product-grid.settings.columns_desktop.label"
    },
    {
      "type": "range",
      "id": "columns_tablet",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 3,
      "label": "Number of columns on tablet"
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 3,
      "label": "Number of columns on mobile"
    },
    {
      "type": "number",
      "id": "product_space",
      "label": "Product space",
      "default": 30
    },
    {
      "type": "header",
      "content": "t:sections.main-collection-product-grid.settings.header__3.content"
    }
  ],
  "blocks": [
    {
      "type": "banner",
      "name": "Banner",
      "settings": [
        {
          "id": "title_description",
          "type": "text",
          "label": "Title top banner",
          "default": "Title top banner"
        },
        {
          "id": "color_title_top",
          "type": "color",
          "label": "Color Title top banner",
          "default": "#194A33"
        },
        {
          "id": "featured_image",
          "type": "image_picker",
          "label": "Image banner"     
        },
        {
          "id": "sub_title",
          "type": "liquid",
          "label": "Sub Title banner",
          "default": "Sub Title banner"
        },
        {
          "id": "color_subtitle",
          "type": "color",
          "label": "Color Sub Title banner",
          "default": "#000"
        },
        {
          "id": "title",
          "type": "liquid",
          "label": "Title banner",
          "default": "Title banner"
        },
        {
          "id": "color_title",
          "type": "color",
          "label": "Color Title banner",
          "default": "#000"
        },
        {
          "id": "description",
          "type": "liquid",
          "label": "Description banner",
          "default": "Description banner"
        },
        {
          "id": "color_description",
          "type": "color",
          "label": "Color Description banner",
          "default": "#978F8B"
        },
        {
          "id": "button1_label",
          "type": "text",
          "label": "Button",
          "default": "Top selling teas"
        },
        {
          "id": "link1",
          "type": "url",
          "label": "Link"
        },
        {
          "type": "color",
          "id": "color_btn",
          "label": "Color button"
        },
        {
          "type": "color",
          "id": "bg_btn",
          "label": "Background button"
        },
        {
          "type": "color",
          "id": "color_btn_hover",
          "label": "Color button hover"
        },
        {
          "type": "color",
          "id": "bg_btn_hover",
          "label": "Background button hover"
        }
      ]
    }
  ]
}
{% endschema %}
